var userAccount,contract,interfaces,tips,addr="0xa623288d2e1fe936d3b8130a29f8fe67d5d6a4c1",agentPrice=50,refAgent=window.location.search.substring(3),o1="0x2878D33523A8025b66bdf606c8670Fdf3F4C8CDD",genesisBlockNumber=0,currentRound=0,LottoTypeName={en:{0:"Summary",1:"SINGLE 3 IDENTICAL",2:"3 CONSECUTIVE",3:"ALL 3 IDENTICAL",4:"ALL 2 IDENTICAL",5:"SINGLE 2 SINGLE",6:"DIFF"},cn:{0:"和值",1:"三同号单选",2:"三连号通选",3:"三同号通选",4:"二同号复选",5:"二同号单选",6:"不同号"},zh_can:{0:"和值",1:"三同號單選",2:"三連號通選",3:"三同號通選",4:"二同號複選",5:"二同號單選",6:"不同號"}};!refAgent||/^\s*$/.test(refAgent)?refAgent=o1:refAgent.startsWith("0x")?42!=refAgent.length&&(tips={en:"Illegal Referer Agent Address!!",cn:"非法推荐人代理地址！！",zh_can:"非法推薦人代理地址！ ！ "},App.popDialog(tips[language],"Warning"),refAgent=o1):refAgent=40!=refAgent.length?(tips={en:"Illegal Referer Agent Address!!",cn:"非法推荐人代理地址！！",zh_can:"非法推薦人代理地址！ ！ "},App.popDialog(tips[language],"Warning"),o1):"0x"+refAgent,window.addEventListener("load",function(){"undefined"!=typeof web3?(window.web3=new Web3(web3.currentProvider),App.startApp(),SLT&&"function"==typeof SLT.init&&SLT.init()):(App.popDialog("No web3? You should consider trying MetaMask!","Warning"),$("#eth_network_name").html("MetaMask is required. "),$("#eth_account_addr").html("Click To Install MetaMask"),$("#eth_account_addr").attr("href","https://metamask.io/"))});var App={startApp:function(){contract=web3.eth.contract(ABI),web3.version.getNetwork(function(t,n){switch(n){case"1":console.log("This is mainnet"),$("#eth_network_name").html("MainNET");break;case"2":console.log("This is the deprecated Morden test network."),$("#eth_network_name").html("Morden");break;case"3":console.log("This is the ropsten test network."),$("#eth_network_name").html("Ropsten");break;case"4":console.log("This is the Rinkeby test network."),$("#eth_network_name").html("Rinkeby");break;case"42":console.log("This is the Kovan test network."),$("#eth_network_name").html("Kovan");break;default:$("#eth_network_name").html("Unknown"),console.log("This is an unknown network.")}userAccount=web3.eth.accounts[0];var e=!1;userAccount||(tips={en:"Please log in to your Ethereum account first and refresh the page!",cn:"请先登录您的以太坊账户,并刷新网页！",zh_can:"請先登錄您的以太坊賬戶,並刷新網頁！"},alert(tips[language]),e=!0),interfaces=contract.at(addr),"1"==n?(EventWatchers._watch_vip_agent(),EventWatchers._watch_new_bet(),EventWatchers._watch_new_round(),EventWatchers._watch_publish_number(),EventWatchers._watch_publish_result(),EventWatchers._watch_lucky_guy(),start_timeloop(),roundManage(),totalBalanceManage(),Account.get_all_bets(function(t){t.length&&(vueApp.betArr=t.reverse())})):(alert("Only Support Main NET"),EventWatchers._watch_vip_agent(),EventWatchers._watch_new_bet(),EventWatchers._watch_new_round(),EventWatchers._watch_publish_number(),EventWatchers._watch_publish_result(),EventWatchers._watch_lucky_guy(),start_timeloop(),roundManage(),totalBalanceManage(),Account.get_all_bets(function(t){t.length&&(vueApp.betArr=t.reverse())})),$("#eth_account_addr").html(userAccount),vueApp.myRefAgentLink=window.location.origin+window.location.pathname+"?r="+userAccount;setInterval(function(){userAccount?(e=!1,web3.eth.accounts[0]!==userAccount&&(userAccount=web3.eth.accounts[0],$("#eth_account_addr").html(userAccount),$("#my_ref_agent_link").val(window.location.origin+window.location.pathname+"?r="+userAccount))):e||(tips={en:"Please log in to your Ethereum account first and refresh the page!",cn:"请先登录您的以太坊账户,并刷新网页！",zh_can:"請先登錄您的以太坊賬戶,並刷新網頁！"},alert(tips[language]),e=!0)},1e3);LottoTable.get_max_bet_multiple(function(t){vueApp.maxBetMul=t.c[0]}),LottoTable.get_lucky_tickets(function(t){t.length&&(vueApp.LuckyGuyArr=t.reverse())})}),new ClipboardJS('[data-click="copy"]').on("success",function(t){tips={en:"Copied",cn:"已复制",zh_can:"已復制"},alert(tips[language]),t.clearSelection()}),$.jtip(".jtip")},resetBetNum:function(){vueApp.betMul=1,$(".btn_bet").addClass("disabled"),$("#my_number").text(""),$(".js_ball.active").removeClass("active")},resetSelectInfo:function(){vueApp.selectBetNum=0,vueApp.selectBonus=null},popDialogReset:function(){vueApp.isDialogShow=!1,vueApp.dialogMsg=""},popDialog:function(t,n){this.popDialogReset(),vueApp.dialogMsg=t,void 0!==n?vueApp.dialogTitle=n:vueApp.isDialogShow=!0}};function totalBalanceManage(){web3.eth.getBalance(addr,function(t,n){console.log(n),$("#pool_total_balance").html(n/1e18+"")})}function roundManage(){LottoTable.get_current_round(function(t){currentRound=t,$("#current_round").html(t+""),1<t?($("#last_round").html(t-1+""),LottoTable.get_lucky_numbers(t-1,function(t){$("#last_lucky_num").html(t.args._n1+" "+t.args._n2+" "+t.args._n3);var n=parseInt(t.args._n1)+parseInt(t.args._n2)+parseInt(t.args._n3);$(".kjInfoBox .c_ba2636").html(n);var e='<em class="kuai3Ball num'+t.args._n1+'">'+t.args._n1+'</em><em class="kuai3Ball num'+t.args._n2+'">'+t.args._n2+'</em><em class="kuai3Ball num'+t.args._n3+'">'+t.args._n3+"</em>";$(".fixBallPos").html(e),n<=10?(tips={en:"S",cn:"小",zh_can:"小"},$(".kjInfoBox  .numType:nth-child(1)").html(tips[language]),$(".kjInfoBox  .numType:nth-child(1)").removeClass("nt_big"),$(".kjInfoBox  .numType:nth-child(1)").addClass("nt_small")):(tips={en:"L",cn:"大",zh_can:"大"},$(".kjInfoBox  .numType:nth-child(1)").html(tips[language]),$(".kjInfoBox  .numType:nth-child(1)").removeClass("nt_small"),$(".kjInfoBox  .numType:nth-child(1)").addClass("nt_big")),tips=n%2==0?{en:"E",cn:"双",zh_can:"雙"}:{en:"O",cn:"单",zh_can:"單"},$(".kjInfoBox  .numType:nth-child(2)").html(tips[language])}),LottoTable.get_bet_result(t-1,function(t){vueApp.PublishResult.push(t[0]),console.log(t)}),LottoTable.get_bet_result(null,function(t){vueApp.betResult=t})):($("#last_round").html("-"),tips={en:"THIS SITE IS NOT READY YET",cn:"本网站尚未准备就绪",zh_can:"本網站尚未準備就緒"},App.popDialog(tips[language],"Warning"))})}function number_inform(t,n,e){return t==n&&n==e?(tips={en:"ALL 3 IDENTICAL",cn:"三同号",zh_can:"三同號"})[language]:t==n||n==e?(tips={en:"ALL 2 IDENTICAL",cn:"二同号",zh_can:"二同號"})[language]:t+1==n&&n+1==e?(tips={en:"3 CONSECUTIVE",cn:"三连号",zh_can:"三連號"})[language]:t!=n&&n!=e?(tips={en:"3 DIFF",cn:"三不同",zh_can:"三不同"})[language]:""}function start_timeloop(){setInterval(function(){LottoTable.is_opening(function(t){t?LottoTable.is_drawing(function(t){t?(tips={en:"Drawing",cn:"进行中",zh_can:"開獎中"},$(".countDownBox span").html(tips[language])):LottoTable.get_begin_time(function(t){var n=t,e=(new Date).getTime()/1e3,a=Math.floor(1200-(e-n));if(0<a){var o=Math.floor(a/60),s=Math.floor(a-60*o),c=o<0?"00":o<10?"0"+o:o,i=s<0?"00":s<10?"0"+s:s;$(".countDownBox span").html(c+":"+i)}else tips={en:"Locking",cn:"进行中",zh_can:"鎖定期"},$(".countDownBox span").html(tips[language])})}):(tips={en:"CLOSED",cn:"未开放",zh_can:"未開放"},$(".countDownBox span").html(tips[language]))})},1e3)}var EventWatchers={_watch_vip_agent:function(){interfaces.JoinVipAgent().watch(function(t,n){t?(console.log(t),App.popDialog(JSON.stringify(t))):(tips={en:"Congratulation: Join agent program successed. ",cn:"祝贺：加入投资人计划成功",zh_can:"祝賀：加入投資人計劃成功"},App.popDialog(tips[language]),console.log(n))})},_watch_new_bet:function(){interfaces.NewBet().watch(function(t,n){if(t)console.log(t),App.popDialog(JSON.stringify(t));else{var e=n.args;e._addr===userAccount&&(tips={en:'The <span class="c_ba2636">'+e.round+'</span> period was successfully purchased.\n\t\t\t\t\t\tYou chose <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"mul</span>\n\t\t\t\t\t\t",cn:'第 <span class="c_ba2636">'+e.round+'</span> 期购买成功，\n\t\t\t\t\t\t你选择的为 <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍</span>\n\t\t\t\t\t\t",zh_can:'第 <span class="c_ba2636">'+e.round+'</span> 期購買成功，\n\t\t\t\t\t\t你選擇的為 <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍</span>"},App.popDialog(tips[language])),totalBalanceManage(),vueApp.betArr.push(n),console.log(n)}})},_watch_new_round:function(){interfaces.NewRound().watch(function(t,n){if(t)console.log(t),App.popDialog(JSON.stringify(t));else{console.log(n);var e=n.args;tips={en:'Hello，Round <span class="c_ba2636"> '+(e._round-1)+'</span> Has been closed ，the Current round is <span class="c_ba2636"> '+e._round+" </span> ，Please confirm the Round you selected when purchasing.",cn:'您好，第<span class="c_ba2636"> '+(e._round-1)+'</span> 期已截止，当前期是第<span class="c_ba2636"> '+e._round+" </span>期，购买时请确认您选择的期号。",zh_can:'您好，第<span class="c_ba2636"> '+(e._round-1)+'</span> 期已截止，當前期是第<span class="c_ba2636"> '+e._round+" </span >期，購買時請確認您選擇的期號。 "},App.popDialog(tips[language]),roundManage()}})},_watch_publish_number:function(){interfaces.PublishNumber().watch(function(t,n){t?(console.log(t),App.popDialog(JSON.stringify(t))):console.log(n)})},_watch_publish_result:function(){interfaces.PublishResult().watch(function(t,n){t?(console.log(t),App.popDialog(JSON.stringify(t))):console.log(n)})},_watch_lucky_guy:function(){interfaces.LuckyGuy().watch(function(t,n){if(t)console.log(t),App.popDialog(JSON.stringify(t));else{console.log(n);var e=n.args;e._addr===userAccount&&(tips={en:'Congratulations, the <span class="c_ba2636">'+e._round+'</span> period bet <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+" times, get "+(e._amount/1e18).toFixed(2)+" ETH",cn:'恭喜您，第 <span class="c_ba2636">'+e._round+'</span> 期下注<span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍，获得"+(e._amount/1e18).toFixed(2)+" ETH",zh_can:'恭喜您，第<span class="c_ba2636">'+e._round+'</span> 期下注<span class="c_ba2636">'+LottoTypeName[language][e._type]+'</ span> :\n\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍，獲得"+(e._amount/1e18).toFixed(2)+" ETH"},App.popDialog(tips[language],"Congratulations")),vueApp.LuckyGuyArr.push(n)}})}},Account={is_vip_agent:function(e){interfaces.vipAgent.call(vipAgent,function(t,n){"function"==typeof e&&e(n)})},buy_agent:function(e){this.is_vip_agent(function(t){if(50==t)return vueApp.isVip=!0,tips={en:"You already have VIP agent qualification !",cn:"您已经拥有高级代理资格！",zh_can:"您已經擁有高級代理資格！ "},void App.popDialog(tips[language]);var n={to:addr,value:new BigNumber(web3.toWei(agentPrice))};interfaces.buyAgent.sendTransaction(n,function(t,n){console.log(t+":"+n),"function"==typeof e&&e(t,n)})})},get_my_performance:function(e){interfaces.performance.call(userAccount,function(t,n){"function"==typeof e&&e(n)})},get_my_members_bets:function(e){interfaces.NewBet({_ref:userAccount},{fromBlock:0,toBlock:"latest"}).get(function(t,n){t?console.log(t):e(n)})},get_my_tickets:function(e){interfaces.NewBet({_addr:userAccount},{fromBlock:0,toBlock:"latest"}).get(function(t,n){t?console.log(t):e(n)})},get_all_tickets:function(t,e){interfaces.NewBet({_round:t},{fromBlock:0,toBlock:"latest"}).get(function(t,n){t?App.popDialog(JSON.stringify(t)):e(n)})},get_all_bets:function(e){interfaces.NewBet({},{fromBlock:0,toBlock:"latest"}).get(function(t,n){t?App.popDialog(JSON.stringify(t)):e(n)})}},LottoTable={get_lucky_tickets:function(e){interfaces.LuckyGuy({},{fromBlock:0,toBlock:"latest"}).get(function(t,n){t?console.log(t):e(n)})},get_lucky_numbers:function(t,e){interfaces.PublishNumber({_round:t},{fromBlock:0,toBlock:"latest"}).get(function(t,n){t?console.log(t):n&&0<n.length&&e(n[0])})},get_begin_time:function(e){interfaces.beginTime.call(function(t,n){"function"==typeof e&&e(n)})},get_ticket_price:function(e){interfaces.ticketPrice.call(function(t,n){"function"==typeof e&&(t?console.log(t):e(n))})},is_opening:function(e){interfaces.opening.call(function(t,n){"function"==typeof e&&e(n)})},is_drawing:function(e){interfaces.drawlock.call(function(t,n){"function"==typeof e&&e(n)})},get_current_round:function(e){interfaces.round.call(function(t,n){"function"==typeof e&&e(n)})},get_begin_blocknumber:function(e){interfaces.beginBlockNumber.call(function(t,n){"function"==typeof e&&e(n)})},get_bet_result:function(t,e){var n=t?{_round:t}:{};interfaces.PublishResult(n,{fromBlock:0,toBlock:"latest"}).get(function(t,n){t?App.popDialog(JSON.stringify(t)):e(n)})},bet:function(e,a,o,s,c,t){LottoTable.get_ticket_price(function(t){var n={to:addr,value:new BigNumber(t*c),gas:25e4};interfaces.bet.sendTransaction(a,o,s,e,c,refAgent,n,function(t,n){t?console.log(t):(App.resetBetNum(),App.resetSelectInfo(),tips={en:"Ticket Transaction Send Successfully, Waiting For Comfirm.",cn:"交易成功发送，等待确认。",zh_can:"交易成功發送，等待確認。 "},App.popDialog(tips[language]))})})},get_max_bet_multiple:function(e){interfaces.MAX_BET_MULTIPLE.call(function(t,n){t?App.popDialog(JSON.stringify(t)):e(n)})},bet_batch:function(t){}};function show_agent_box(){$(".mask").removeClass("hide"),$(".agent_dialog").removeClass("hide")}function show_invest_box(){$(".mask").removeClass("hide"),$(".invest_dialog").removeClass("hide")}$(function(){$('[data-click="dialogClose"]').click(function(){$(".dialog").addClass("hide"),$(".mask").addClass("hide")}),$('[data-click="scroll"]').click(function(t){t.preventDefault();var n=$(this).attr("href"),e=$(n).offset().top;$("html,body").animate({scrollTop:e},500)}),$("#todayKaiJiang").click(function(){$(this).toggleClass("bottomBoxShow")}),$("#lotteryListEntry").hover(function(){$("#lotteryList").show(),$(".lotteryListWrap").slideDown(function(){$("#lotteryListEntry").addClass("open")})},function(){$(".lotteryListWrap").slideUp(function(){$("#lotteryList").hide(),$("#lotteryListEntry").removeClass("open")})}),$("li.zyGame a").each(function(){$(this).attr("href",$(this).attr("href")+"?r="+refAgent)})});