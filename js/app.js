var userAccount,contract,interfaces,tips,addr="0xa623288d2e1fe936d3b8130a29f8fe67d5d6a4c1",agentPrice=50,refAgent=window.location.search.substring(3),o1="0x2878D33523A8025b66bdf606c8670Fdf3F4C8CDD",genesisBlockNumber=0,currentRound=0,LottoTypeName={en:{0:"Summary",1:"SINGLE 3 IDENTICAL",2:"3 CONSECUTIVE",3:"ALL 3 IDENTICAL",4:"ALL 2 IDENTICAL",5:"SINGLE 2 SINGLE",6:"DIFF"},cn:{0:"和值",1:"三同号单选",2:"三连号通选",3:"三同号通选",4:"二同号复选",5:"二同号单选",6:"不同号"},zh_can:{0:"和值",1:"三同號單選",2:"三連號通選",3:"三同號通選",4:"二同號複選",5:"二同號單選",6:"不同號"}};!refAgent||/^\s*$/.test(refAgent)?refAgent=o1:refAgent.startsWith("0x")?42!=refAgent.length&&(tips={en:"Illegal Referer Agent Address!!",cn:"非法推荐人代理地址！！",zh_can:"非法推薦人代理地址！ ！ "},popDialog(tips[language],"Warning"),refAgent=o1):refAgent=40!=refAgent.length?(tips={en:"Illegal Referer Agent Address!!",cn:"非法推荐人代理地址！！",zh_can:"非法推薦人代理地址！ ！ "},popDialog(tips[language],"Warning"),o1):"0x"+refAgent,window.addEventListener("load",function(){"undefined"!=typeof web3?(window.web3=new Web3(web3.currentProvider),App.startApp(),SLT&&"function"==typeof SLT.init&&SLT.init()):(popDialog("No web3? You should consider trying MetaMask!","Warning"),$("#eth_network_name").html("MetaMask is required. "),$("#eth_account_addr").html("Click To Install MetaMask"),$("#eth_account_addr").attr("href","https://metamask.io/"))});var App={startApp:function(){(userAccount=web3.eth.accounts[0])?(contract=web3.eth.contract(ABI),web3.version.getNetwork(function(n,t){switch(t){case"1":console.log("This is mainnet"),$("#eth_network_name").html("MainNET");break;case"2":console.log("This is the deprecated Morden test network."),$("#eth_network_name").html("Morden");break;case"3":console.log("This is the ropsten test network."),$("#eth_network_name").html("Ropsten");break;case"4":console.log("This is the Rinkeby test network."),$("#eth_network_name").html("Rinkeby");break;case"42":console.log("This is the Kovan test network."),$("#eth_network_name").html("Kovan");break;default:$("#eth_network_name").html("Unknown"),console.log("This is an unknown network.")}interfaces=contract.at(addr),EventWatchers._watch_vip_agent(),EventWatchers._watch_new_bet(),EventWatchers._watch_new_round(),EventWatchers._watch_publish_number(),EventWatchers._watch_publish_result(),EventWatchers._watch_lucky_guy(),start_timeloop(),roundManage(),totalBalanceManage(),$("#eth_account_addr").html(userAccount),vueApp.myRefAgentLink=window.location.origin+"/?r="+userAccount;var e=setInterval(function(){if(!userAccount)return popDialog("please login your ethereum account first!","Warning"),void clearInterval(e);web3.eth.accounts[0]!==userAccount&&(userAccount=web3.eth.accounts[0],$("#eth_account_addr").html(userAccount),$("#my_ref_agent_link").val(window.location.origin+"/?r="+userAccount))},1e3);Account.is_vip_agent(function(n){vueApp.isVip=50==n}),LottoTable.get_max_bet_multiple(function(n){vueApp.maxBetMul=n.c[0]}),LottoTable.get_lucky_tickets(function(n){n.length&&(vueApp.LuckyGuyArr=n.reverse())})}),new ClipboardJS('[data-click="copy"]').on("success",function(n){tips={en:"Copied",cn:"已复制",zh_can:"已復制"},alert(tips[language]),n.clearSelection()}),$.jtip(".jtip")):popDialog("please login your ethereum account first!","Warning")}};function totalBalanceManage(){web3.eth.getBalance(addr,function(n,t){console.log(t),$("#pool_total_balance").html(t/1e18+"")})}function roundManage(){LottoTable.get_current_round(function(n){currentRound=n,$("#current_round").html(n+""),1<n?($("#last_round").html(n-1+""),LottoTable.get_lucky_numbers(n-1,function(n){$("#last_lucky_num").html(n.args._n1+" "+n.args._n2+" "+n.args._n3);var t=parseInt(n.args._n1)+parseInt(n.args._n2)+parseInt(n.args._n3);$(".kjInfoBox .c_ba2636").html(t);var e='<em class="kuai3Ball num'+n.args._n1+'">'+n.args._n1+'</em><em class="kuai3Ball num'+n.args._n2+'">'+n.args._n2+'</em><em class="kuai3Ball num'+n.args._n3+'">'+n.args._n3+"</em>";$(".fixBallPos").html(e),t<=10?(tips={en:"S",cn:"小",zh_can:"小"},$(".kjInfoBox  .numType:nth-child(1)").html(tips[language]),$(".kjInfoBox  .numType:nth-child(1)").removeClass("nt_big"),$(".kjInfoBox  .numType:nth-child(1)").addClass("nt_small")):(tips={en:"L",cn:"大",zh_can:"大"},$(".kjInfoBox  .numType:nth-child(1)").html(tips[language]),$(".kjInfoBox  .numType:nth-child(1)").removeClass("nt_small"),$(".kjInfoBox  .numType:nth-child(1)").addClass("nt_big")),tips=t%2==0?{en:"E",cn:"双",zh_can:"雙"}:{en:"O",cn:"单",zh_can:"單"},$(".kjInfoBox  .numType:nth-child(2)").html(tips[language])}),LottoTable.get_bet_result(n-1,function(n){vueApp.PublishResult.push(n[0]),console.log(n)}),LottoTable.get_bet_result(null,function(n){vueApp.betResult=n})):($("#last_round").html("-"),tips={en:"THIS SITE IS NOT READY YET",cn:"本网站尚未准备就绪",zh_can:"本網站尚未準備就緒"},popDialog(tips[language],"Warning"))})}function number_inform(n,t,e){return n==t&&t==e?(tips={en:"ALL 3 IDENTICAL",cn:"三同号",zh_can:"三同號"})[language]:n==t||t==e?(tips={en:"ALL 2 IDENTICAL",cn:"二同号",zh_can:"二同號"})[language]:n+1==t&&t+1==e?(tips={en:"3 CONSECUTIVE",cn:"三连号",zh_can:"三連號"})[language]:n!=t&&t!=e?(tips={en:"3 DIFF",cn:"三不同",zh_can:"三不同"})[language]:""}function start_timeloop(){setInterval(function(){LottoTable.is_opening(function(n){n?LottoTable.is_drawing(function(n){n?(tips={en:"Drawing",cn:"开奖中",zh_can:"開獎中"},$(".countDownBox span").html(tips[language])):LottoTable.get_begin_time(function(n){var t=n,e=(new Date).getTime()/1e3,a=Math.floor(1200-(e-t));if(0<a){var o=Math.floor(a/60),c=Math.floor(a-60*o),s=o<0?"00":o<10?"0"+o:o,i=c<0?"00":c<10?"0"+c:c;$(".countDownBox span").html(s+":"+i)}else tips={en:"Locking",cn:"锁定期",zh_can:"鎖定期"},$(".countDownBox span").html(tips[language])})}):(tips={en:"Not Open Yet",cn:"未开放",zh_can:"未開放"},$(".countDownBox span").html(tips[language]))})},1e3)}var EventWatchers={_watch_vip_agent:function(){interfaces.JoinVipAgent().watch(function(n,t){n?(console.log(n),popDialog(JSON.stringify(n))):(tips={en:"Congratulation: Join agent program successed. ",cn:"祝贺：加入投资人计划成功",zh_can:"祝賀：加入投資人計劃成功"},popDialog(tips[language]),console.log(t))})},_watch_new_bet:function(){interfaces.NewBet().watch(function(n,t){if(n)console.log(n),popDialog(JSON.stringify(n));else{var e=t.args;e._addr===userAccount&&(tips={en:'The <span class="c_ba2636">'+e.round+'</span> period was successfully purchased.\n\t\t\t\t\t\tYou chose <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"mul</span>\n\t\t\t\t\t\t",cn:'第 <span class="c_ba2636">'+e.round+'</span> 期购买成功，\n\t\t\t\t\t\t你选择的为 <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍</span>\n\t\t\t\t\t\t",zh_can:'第 <span class="c_ba2636">'+e.round+'</span> 期購買成功，\n\t\t\t\t\t\t你選擇的為 <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍</span>"},popDialog(tips[language])),totalBalanceManage(),vueApp.betArr.push(t),console.log(t)}})},_watch_new_round:function(){interfaces.NewRound().watch(function(n,t){if(n)console.log(n),popDialog(JSON.stringify(n));else{console.log(t);var e=t.args;tips={en:'Hello，Round <span class="c_ba2636"> '+(e._round-1)+'</span> Has been closed ，the Current round is <span class="c_ba2636"> '+e._round+" </span> ，Please confirm the Round you selected when purchasing.",cn:'您好，第<span class="c_ba2636"> '+(e._round-1)+'</span> 期已截止，当前期是第<span class="c_ba2636"> '+e._round+" </span>期，购买时请确认您选择的期号。",zh_can:'您好，第<span class="c_ba2636"> '+(e._round-1)+'</span> 期已截止，當前期是第<span class="c_ba2636"> '+e._round+" </span >期，購買時請確認您選擇的期號。 "},popDialog(tips[language]),roundManage()}})},_watch_publish_number:function(){interfaces.PublishNumber().watch(function(n,t){n?(console.log(n),popDialog(JSON.stringify(n))):console.log(t)})},_watch_publish_result:function(){interfaces.PublishResult().watch(function(n,t){n?(console.log(n),popDialog(JSON.stringify(n))):console.log(t)})},_watch_lucky_guy:function(){interfaces.LuckyGuy().watch(function(n,t){if(n)console.log(n),popDialog(JSON.stringify(n));else{console.log(t);var e=t.args;e._addr===userAccount&&(tips={en:'Congratulations, the <span class="c_ba2636">'+e._round+'</span> period bet <span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+" times, get "+(e._amount/1e18).toFixed(2)+" ETH",cn:'恭喜您，第 <span class="c_ba2636">'+e._round+'</span> 期下注<span class="c_ba2636">'+LottoTypeName[language][e._type]+'</span> :\n\t\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍，获得"+(e._amount/1e18).toFixed(2)+" ETH",zh_can:'恭喜您，第<span class="c_ba2636">'+e._round+'</span> 期下注<span class="c_ba2636">'+LottoTypeName[language][e._type]+'</ span> :\n\t\t\t\t\t<span class="c_ba2636">'+(0<e._n1?e._n1:"")+" "+(0<e._n2?e._n2:"")+" "+(0<e._n3?e._n3:"")+'</span>,\n\t\t\t\t\t<span class="c_ba2636">'+e._mul+"倍，獲得"+(e._amount/1e18).toFixed(2)+" ETH"},popDialog(tips[language],"Congratulations")),vueApp.LuckyGuyArr.push(t)}})}},Account={is_vip_agent:function(e){interfaces.vipAgent.call(userAccount,function(n,t){"function"==typeof e&&e(t)})},buy_agent:function(e){this.is_vip_agent(function(n){if(50==n)return vueApp.isVip=!0,tips={en:"You already have VIP agent qualification !",cn:"您已经拥有高级代理资格！",zh_can:"您已經擁有高級代理資格！ "},void popDialog(tips[language]);var t={to:addr,value:new BigNumber(web3.toWei(agentPrice))};interfaces.buyAgent.sendTransaction(t,function(n,t){console.log(n+":"+t),"function"==typeof e&&e(n,t)})})},get_my_performance:function(e){interfaces.performance.call(userAccount,function(n,t){"function"==typeof e&&e(t)})},get_my_members_bets:function(e){interfaces.NewBet({_ref:userAccount},{fromBlock:0,toBlock:"latest"}).get(function(n,t){n?console.log(n):e(t)})},get_my_tickets:function(e){interfaces.NewBet({_addr:userAccount},{fromBlock:0,toBlock:"latest"}).get(function(n,t){n?console.log(n):e(t)})},get_all_tickets:function(n,e){interfaces.NewBet({_round:n},{fromBlock:0,toBlock:"latest"}).get(function(n,t){n?popDialog(JSON.stringify(n)):e(t)})}},LottoTable={get_lucky_tickets:function(e){interfaces.LuckyGuy({},{fromBlock:0,toBlock:"latest"}).get(function(n,t){n?console.log(n):e(t)})},get_lucky_numbers:function(n,e){interfaces.PublishNumber({_round:n},{fromBlock:0,toBlock:"latest"}).get(function(n,t){n?console.log(n):t&&0<t.length&&e(t[0])})},get_begin_time:function(e){interfaces.beginTime.call(function(n,t){"function"==typeof e&&e(t)})},get_ticket_price:function(e){interfaces.ticketPrice.call(function(n,t){"function"==typeof e&&(n?console.log(n):e(t))})},is_opening:function(e){interfaces.opening.call(function(n,t){"function"==typeof e&&e(t)})},is_drawing:function(e){interfaces.drawlock.call(function(n,t){"function"==typeof e&&e(t)})},get_current_round:function(e){interfaces.round.call(function(n,t){"function"==typeof e&&e(t)})},get_begin_blocknumber:function(e){interfaces.beginBlockNumber.call(function(n,t){"function"==typeof e&&e(t)})},get_bet_result:function(n,e){var t=n?{_round:n}:{};interfaces.PublishResult(t,{fromBlock:0,toBlock:"latest"}).get(function(n,t){n?popDialog(JSON.stringify(n)):e(t)})},bet:function(e,a,o,c,s,n){LottoTable.get_ticket_price(function(n){var t={to:addr,value:new BigNumber(n*s),gas:25e4};interfaces.bet.sendTransaction(a,o,c,e,s,refAgent,t,function(n,t){n&&console.log(n)})})},get_max_bet_multiple:function(e){interfaces.MAX_BET_MULTIPLE.call(function(n,t){n?popDialog(JSON.stringify(n)):e(t)})},bet_batch:function(n){}};function show_agent_box(){$(".mask").removeClass("hide"),$(".agent_dialog").removeClass("hide")}function show_invest_box(){$(".mask").removeClass("hide"),$(".invest_dialog").removeClass("hide")}$(function(){$('[data-click="dialogClose"]').click(function(){$(".dialog").addClass("hide"),$(".mask").addClass("hide")}),$('[data-click="scroll"]').click(function(n){n.preventDefault();var t=$(this).attr("href"),e=$(t).offset().top;$("html,body").animate({scrollTop:e},500)}),$("#todayKaiJiang").click(function(){$(this).toggleClass("bottomBoxShow")}),$("#lotteryListEntry").hover(function(){$("#lotteryList").show(),$(".lotteryListWrap").slideDown(function(){$("#lotteryListEntry").addClass("open")})},function(){$(".lotteryListWrap").slideUp(function(){$("#lotteryList").hide(),$("#lotteryListEntry").removeClass("open")})})});